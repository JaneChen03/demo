kind: pipeline
type: docker
name: default

steps:
- name: 编译分支代码
  image: juanchen03/newtest:1.0
  pull: always
  commands:
    - pwd
    - ls -la
    - npm install
    - ln -sfn /drone/node_modules node_modules
    - ls -la
    - npm run build
    - ls -la

- name: devlop
  image: juanchen03/nginx2.0
  pull: always
  commands:
    - ls
    - pwd
    - mkdir /mount-data
    - mount 106.13.3.168:/usr/local/nginx/html/mount-data -o proto-tcp -o nolock
    - rm - Rf /mount-data/*
    - cp dist/* /mount-data
    
  when:
    branch: main
    event: push
    
    
trigger:
  branch:
    include:
      - main
  event:
    include:
      - push
